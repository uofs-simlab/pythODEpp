#ifndef ARK5_H
#define ARK5_H

#include <methods/rk.h>

class ARK5 : public IMEX {
public:
	ARK5(Hash<ParamValue>& params, BaseIVP* ivp) : IMEX(params, ivp, 8) {
		_a(1,0) = 41.0/200.0; _a(1,1) = 41.0/200.0;
		_a(2,0) = 41.0/400.0; _a(2,1) = -567603406766.0/11931857230679.0; _a(2,2) = 41.0/200.0;
		_a(3,0) = 683785636431.0/9252920307686.0; _a(3,2) = -110385047103.0/1367015193373.0; _a(3,3) = 41.0/200.0;

		_a(4,0) = 3016520224154.0/10081342136671.0; _a(4,2) = 30586259806659.0/12414158314087.0;
		_a(4,3) = -22760509404356.0/11113319521817.0; _a(4,4) = 41.0/200.0;

		_a(5,0) = 218866479029.0/1489978393911.0; _a(5,2) = 638256894668.0/5436446318841.0;
		_a(5,3) = -1179710474555.0/5321154724896.0; _a(5,4) = -60928119172.0/8023461067671.0; _a(5,5) = 41.0/200.0;

		_a(6,0) = 1020004230633.0/5715676835656.0; _a(6,2) = 25762820946817.0/25263940353407.0; _a(6,3) = -2161375909145.0/9755907335909.0;
		_a(6,4) = -211217309593.0/5846859502534.0; _a(6,5) = -4269925059573.0/7827059040749.0; _a(6,6) = 41.0/200.0;

		_a(7,0) = -872700587467.0/9133579230613.0; _a(7,3) = 22348218063261.0/9555858737531.0; _a(7,4) = -1143369518992.0/8141816002931.0;
		_a(7,5) = -39379526789629.0/19018526304540.0; _a(7,6) = 32727382324388.0/42900044865799.0; _a(7,7) = 41.0/200.0;
		
		_a2(1,0) = 41.0/100.0;
		_a2(2,0) = 367902744464.0/2072280473677.0; _a2(2,1) = 677623207551.0/8224143866563.0;

		_a2(3,0) = 1268023523408.0/10340822734521.0; _a2(3,2) = 1029933939417.0/13636558850479.0;

		_a2(4,0) = 14463281900351.0/6315353703477.0; _a2(4,2) = 66114435211212.0/5879490589093.0;
		_a2(4,3) = -54053170152839.0/4284798021562.0;

		_a2(5,0) = 14090043504691.0/34967701212078.0; _a2(5,2) = 15191511035443.0/11219624916014.0;
		_a2(5,3) = -18461159152457.0/12425892160975.0; _a2(5,4) = -281667163811.0/9011619295870.0;

		_a2(6,0) = 19230459214898.0/13134317526959.0; _a2(6,2) = 21275331358303.0/2942455364971.0;
		_a2(6,3) = -38145345988419.0/4862620318723.0; _a2(6,4) = -1.0/8.0; _a2(6,5) = -1.0/8.0;

		_a2(7,0) = -19977161125411.0/11928030595625.0; _a2(7,2) = -40795976796054.0/6384907823539.0;
		_a2(7,3) = 177454434618887.0/12078138498510.0; _a2(7,4) = 782672205425.0/8267701900261.0;
		_a2(7,5) = -69563011059811.0/9646580694205.0; _a2(7,6) = 7356628210526.0/4942186776405.0;

		_b(0) = _b2(0) = -872700587467.0/9133579230613.0;
		_b(3) = _b2(3) = 22348218063261.0/9555858737531.0;
		_b(4) = _b2(4) = -1143369518992.0/8141816002931.0;
		_b(5) = _b2(5) = -39379526789629.0/19018526304540.0;
		_b(6) = _b2(6) = 32727382324388.0/42900044865799.0;
		_b(7) = _b2(7) = 41.0/200.0;

		_baux(0) = _baux2(0) = -975461918565.0/9796059967033.0;
		_baux(3) = _baux2(3) = 78070527104295.0/32432590147079.0;
		_baux(4) = _baux2(4) = -548382580838.0/3424219808633.0;
		_baux(5) = _baux2(5) = -33438840321285.0/15594753105479.0;
		_baux(6) = _baux2(6) = 3629800801594.0/4656183773603.0;
		_baux(7) = _baux2(7) = 4035322873751.0/18575991585200.0;

		FillC();
		FillC2();
	}   

	virtual const char* GetName() const {
		return "ARK 5(4)";
	}   

	virtual long GetOrder() const {
		return 5;
	}   

	virtual long GetAuxOrder() const {
		return 4;
	}   
};

#endif

