#ifndef ARK3_H
#define ARK3_H

#include <methods/rk.h>

class ARK3 : public IMEX {
public:
	ARK3(Hash<ParamValue>& params, BaseIVP* ivp) : IMEX(params, ivp, 4) {
		_a(1,0) = 1767732205903.0/4055673282236.0;
		_a(1,1) = _a(1,0);
		_a(2,0) = 2746238789719.0/10658868560708.0;
		_a(2,1) = -640167445237.0/6845629431997.0;
		_a(2,2) = _a(1,0);
		_a(3,0) = 1471266399579.0/7840856788654.0;
		_a(3,1) = -4482444167858.0/7529755066697.0;
		_a(3,2) = 11266239266428.0/11593286722821.0;
		_a(3,3) = _a(1,0);

		_a2(1,0) = 1767732205903.0/2027836641118.0;
		_a2(2,0) = 5535828885825.0/10492691773637.0;
		_a2(2,1) = 788022342437.0/10882634858940.0;
		_a2(3,0) = 6485989280629.0/16251701735622.0;
		_a2(3,1) = -4246266847089.0/9704473918619.0;
		_a2(3,2) = 10755448449292.0/10357097424841.0;

		_b(0) = _b2(0) = 1471266399579.0/7840856788654.0;
		_b(1) = _b2(1) = -4482444167858.0/7529755066697.0;
		_b(2) = _b2(2) = 11266239266428.0/11593286722821.0;
		_b(3) = _b2(3) = 1767732205903.0/4055673282236.0;
		
		_baux(0) = _baux2(0) = 2756255671327.0/12835298489170.0;
		_baux(1) = _baux2(1) = -10771552573575.0/22201958757719.0;
		_baux(2) = _baux2(2) = 9247589265047.0/10645013368117.0;
		_baux(3) = _baux2(3) = 2193209047091.0/5459859503100.0;
	
		FillC();
		FillC2();
	}

	virtual const char* GetName() const {
		return "ARK 3(2)";
	}
	
	virtual long GetOrder() const {
		return 3;
	}
	
	virtual long GetAuxOrder() const {
		return 2;
	}
};

#endif

