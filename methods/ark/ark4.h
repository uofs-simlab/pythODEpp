#ifndef ARK4_H
#define ARK4_H

#include <methods/rk.h>

class ARK4 : public IMEX {
public:
	ARK4(Hash<ParamValue>& params, BaseIVP* ivp) : IMEX(params, ivp, 6) {
        _a(1,0) = 1./4.; _a(1,1) = 1./4.;
        _a(2,0) = 8611./62500.; _a(2,1) = -1743./31250.; _a(2,2) = 1./4.;
        _a(3,0) = 5012029./34652500.; _a(3,1) = -654441./2922500.; _a(3,2) = 174375./388108.; _a(3,3) = 1./4.;
		_a(4,0) = 15267082809./155376265600.; _a(4,1) = -71443401./120774400.; _a(4,2) = 730878875./902184768.; _a(4,3) = 2285395./8070912.; _a(4,4) = 1./4.;
        _a(5,0) = 82889./524892.; _a(5,1) = 0.; _a(5,2) = 15625./83664.; _a(5,3) = 69875./102672.; _a(5,4) = -2260./8211.; _a(5,5) = 1./4.;

		_a2(1,0) = 1.0/2.0;
		_a2(2,0) = 13861.0/62500.0; _a2(2,1) = 6889.0/62500.0;
		_a2(3,0) = -116923316275.0/2393684061468.0; _a2(3,1) = -2731218467317.0/15368042101831.0; _a2(3,2) = 9408046702089.0/11113171139209.0;
		_a2(4,0) = -451086348788.0/2902428689909.0; _a2(4,1) = -2682348792572.0/7519795681897.0;
		_a2(4,2) = 12662868775082.0/11960479115383.0; _a2(4,3) = 3355817975965.0/11060851509271.0;

		_a2(5,0) = 647845179188.0/3216320057751.0; _a2(5,1) = 73281519250.0/8382639484533.0;
		_a2(5,2) = 552539513391.0/3454668386233.0; _a2(5,3) = 3354512671639.0/8306763924573.0;
		_a2(5,4) = 4040.0/17871.0;

		_b(0) = _b2(0) = 82889.0/524892.0;
		_b(1) = _b2(1) = 0.0;
		_b(2) = _b2(2) = 15625.0/83664.0;
		_b(3) = _b2(3) = 69875.0/102672.0;
		_b(4) = _b2(4) = -2260.0/8211.0;
		_b(5) = _b2(5) = 1.0/4.0;

        _baux(0) = _baux2(0) = 4586570599.0/29645900160.0;
		_baux(1) = _baux2(1) = 0.0;
		_baux(2) = _baux2(2) = 178811875.0/945068544.0;
		_baux(3) = _baux2(3) = 814220225.0/1159782912.0;
		_baux(4) = _baux2(4) = -3700637.0/11593932.0;
		_baux(5) = _baux2(5) = 61727.0/225920.0;

		FillC();
		FillC2();
	}

	virtual const char* GetName() const {
		return "ARK 4(3)";
	}
	
	virtual long GetOrder() const {
		return 4;
	}
	
	virtual long GetAuxOrder() const {
		return 3;
	}
};

#endif

